
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="A fullstack but simple mail server (SMTP, IMAP, LDAP, Antispam, Antivirus, etc.) using Docker.">
      
      
      
        <meta name="author" content="docker-mailserver (Github Organization)">
      
      
      <link rel="shortcut icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-7.0.3">
    
    
      
        <title>FAQ - Docker Mailserver</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.1655a90d.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.7fa14f5b.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
      
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#what-kind-of-database-are-you-using" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Docker Mailserver" class="md-header__button md-logo" aria-label="Docker Mailserver">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Docker Mailserver
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              FAQ
            
          </span>
        </div>
      </div>
    </div>
    <div class="md-header__options">
      
    </div>
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/docker-mailserver/docker-mailserver/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    docker-mailserver
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    




<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Docker Mailserver" class="md-nav__button md-logo" aria-label="Docker Mailserver">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    Docker Mailserver
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/docker-mailserver/docker-mailserver/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    docker-mailserver
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../introduction/" class="md-nav__link">
        An Introduction to Mail Servers
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      <label class="md-nav__link" for="__nav_3">
        Configuration
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Configuration" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Configuration
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../setup.sh/" class="md-nav__link">
        Your Best Friend setup.sh
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_2" type="checkbox" id="__nav_3_2" >
      
      <label class="md-nav__link" for="__nav_3_2">
        User Management
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="User Management" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_2">
          <span class="md-nav__icon md-icon"></span>
          User Management
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../user-management/accounts/" class="md-nav__link">
        Accounts
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../user-management/aliases/" class="md-nav__link">
        Aliases
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_3" type="checkbox" id="__nav_3_3" >
      
      <label class="md-nav__link" for="__nav_3_3">
        Best Practices
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Best Practices" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_3">
          <span class="md-nav__icon md-icon"></span>
          Best Practices
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../best-practices/dkim/" class="md-nav__link">
        DKIM
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../best-practices/dmarc/" class="md-nav__link">
        DMARC
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../best-practices/spf/" class="md-nav__link">
        SPF
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../best-practices/autodiscover/" class="md-nav__link">
        Auto-discovery
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_4" type="checkbox" id="__nav_3_4" >
      
      <label class="md-nav__link" for="__nav_3_4">
        Security
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Security" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_4">
          <span class="md-nav__icon md-icon"></span>
          Security
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../security/understanding-the-ports/" class="md-nav__link">
        Understanding the Ports
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../security/ssl/" class="md-nav__link">
        SSL/TLS
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../security/fail2ban/" class="md-nav__link">
        Fail2Ban
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_5" type="checkbox" id="__nav_3_5" >
      
      <label class="md-nav__link" for="__nav_3_5">
        Troubleshooting
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Troubleshooting" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_5">
          <span class="md-nav__icon md-icon"></span>
          Troubleshooting
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../debugging/" class="md-nav__link">
        Debugging
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          FAQ
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        FAQ
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#what-kind-of-database-are-you-using" class="md-nav__link">
    What kind of database are you using?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#where-are-emails-stored" class="md-nav__link">
    Where are emails stored?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-alter-the-running-mailserver-instance-without-relaunching-the-container" class="md-nav__link">
    How to alter the running mailserver instance without relaunching the container?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-can-i-sync-container-with-host-datetime-timezone" class="md-nav__link">
    How can I sync container with host date/time? Timezone?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-is-the-file-format" class="md-nav__link">
    What is the file format?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-about-backups" class="md-nav__link">
    What about backups?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-about-mail-state-folder" class="md-nav__link">
    What about mail-state folder?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-can-i-configure-my-email-client" class="md-nav__link">
    How can I configure my email client?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-can-i-manage-my-custom-spamassassin-rules" class="md-nav__link">
    How can I manage my custom Spamassassin rules?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-are-acceptable-sa_spam_subject-values" class="md-nav__link">
    What are acceptable SA_SPAM_SUBJECT values?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#can-i-use-nakedbare-domains-no-host-name" class="md-nav__link">
    Can I use naked/bare domains (no host name)?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#why-are-spamassassin-x-headers-not-inserted-into-my-sampledomaincom-subdomain-emails" class="md-nav__link">
    Why are Spamassassin x-headers not inserted into my sample.domain.com subdomain emails?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-can-i-make-spamassassin-learn-spam" class="md-nav__link">
    How can I make SpamAssassin learn spam?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-can-i-configure-a-catch-all" class="md-nav__link">
    How can I configure a catch-all?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-can-i-delete-all-the-e-mails-for-a-specific-user" class="md-nav__link">
    How can I delete all the e-mails for a specific user?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-do-i-have-more-control-about-what-spamassasin-is-filtering" class="md-nav__link">
    How do I have more control about what SPAMASSASIN is filtering?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-kind-of-ssl-certificates-can-i-use" class="md-nav__link">
    What kind of SSL certificates can I use?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#i-just-moved-from-my-old-mail-server-but-it-doesnt-work" class="md-nav__link">
    I just moved from my old mail server but "it doesn't work".
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#which-system-requirements-needs-my-container-to-run-docker-mailserver-effectively" class="md-nav__link">
    Which system requirements needs my container to run docker-mailserver effectively?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#is-docker-mailserver-running-in-a-rancher-environment" class="md-nav__link">
    Is docker-mailserver running in a rancher environment?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-can-i-authenticate-users-with-smtp_only" class="md-nav__link">
    How can I authenticate users with SMTP_ONLY?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#common-errors" class="md-nav__link">
    Common errors
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#using-behind-proxy" class="md-nav__link">
    Using behind proxy
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-about-updates" class="md-nav__link">
    What about updates
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#howto-adjust-settings-with-the-user-patchessh-script" class="md-nav__link">
    Howto adjust settings with the user-patches.sh script
  </a>
  
    <nav class="md-nav" aria-label="Howto adjust settings with the user-patches.sh script">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#special-case-patching-supervisord-config" class="md-nav__link">
    Special case patching supervisord config
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../pop3/" class="md-nav__link">
        Mail Delivery with POP3
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      <label class="md-nav__link" for="__nav_4">
        Advanced
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Advanced" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Advanced
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../advanced/optional-config/" class="md-nav__link">
        Optional Configuration
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_2" type="checkbox" id="__nav_4_2" >
      
      <label class="md-nav__link" for="__nav_4_2">
        Maintenance
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Maintenance" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_2">
          <span class="md-nav__icon md-icon"></span>
          Maintenance
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../advanced/maintenance/update-and-cleanup/" class="md-nav__link">
        Update and Cleanup
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3" type="checkbox" id="__nav_4_3" >
      
      <label class="md-nav__link" for="__nav_4_3">
        Override the Default Configs
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Override the Default Configs" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_3">
          <span class="md-nav__icon md-icon"></span>
          Override the Default Configs
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../advanced/override-defaults/dovecot/" class="md-nav__link">
        Dovecot
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../advanced/override-defaults/postfix/" class="md-nav__link">
        Postfix
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../advanced/auth-ldap/" class="md-nav__link">
        LDAP Authentication
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../advanced/mail-sieve/" class="md-nav__link">
        Email Filtering with Sieve
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../advanced/mail-fetchmail/" class="md-nav__link">
        Email Gathering with Fetchmail
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_7" type="checkbox" id="__nav_4_7" >
      
      <label class="md-nav__link" for="__nav_4_7">
        Email Forwarding
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Email Forwarding" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_7">
          <span class="md-nav__icon md-icon"></span>
          Email Forwarding
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../advanced/mail-forwarding/relay-hosts/" class="md-nav__link">
        Relay Hosts
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../advanced/mail-forwarding/aws-ses/" class="md-nav__link">
        AWS SES
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../advanced/full-text-search/" class="md-nav__link">
        Full-Text Search
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../advanced/kubernetes/" class="md-nav__link">
        Kubernetes
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../advanced/ipv6/" class="md-nav__link">
        IPv6
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" checked>
      
      <label class="md-nav__link" for="__nav_5">
        Tutorials
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Tutorials" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Tutorials
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          FAQ
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        FAQ
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#what-kind-of-database-are-you-using" class="md-nav__link">
    What kind of database are you using?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#where-are-emails-stored" class="md-nav__link">
    Where are emails stored?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-alter-the-running-mailserver-instance-without-relaunching-the-container" class="md-nav__link">
    How to alter the running mailserver instance without relaunching the container?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-can-i-sync-container-with-host-datetime-timezone" class="md-nav__link">
    How can I sync container with host date/time? Timezone?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-is-the-file-format" class="md-nav__link">
    What is the file format?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-about-backups" class="md-nav__link">
    What about backups?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-about-mail-state-folder" class="md-nav__link">
    What about mail-state folder?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-can-i-configure-my-email-client" class="md-nav__link">
    How can I configure my email client?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-can-i-manage-my-custom-spamassassin-rules" class="md-nav__link">
    How can I manage my custom Spamassassin rules?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-are-acceptable-sa_spam_subject-values" class="md-nav__link">
    What are acceptable SA_SPAM_SUBJECT values?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#can-i-use-nakedbare-domains-no-host-name" class="md-nav__link">
    Can I use naked/bare domains (no host name)?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#why-are-spamassassin-x-headers-not-inserted-into-my-sampledomaincom-subdomain-emails" class="md-nav__link">
    Why are Spamassassin x-headers not inserted into my sample.domain.com subdomain emails?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-can-i-make-spamassassin-learn-spam" class="md-nav__link">
    How can I make SpamAssassin learn spam?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-can-i-configure-a-catch-all" class="md-nav__link">
    How can I configure a catch-all?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-can-i-delete-all-the-e-mails-for-a-specific-user" class="md-nav__link">
    How can I delete all the e-mails for a specific user?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-do-i-have-more-control-about-what-spamassasin-is-filtering" class="md-nav__link">
    How do I have more control about what SPAMASSASIN is filtering?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-kind-of-ssl-certificates-can-i-use" class="md-nav__link">
    What kind of SSL certificates can I use?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#i-just-moved-from-my-old-mail-server-but-it-doesnt-work" class="md-nav__link">
    I just moved from my old mail server but "it doesn't work".
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#which-system-requirements-needs-my-container-to-run-docker-mailserver-effectively" class="md-nav__link">
    Which system requirements needs my container to run docker-mailserver effectively?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#is-docker-mailserver-running-in-a-rancher-environment" class="md-nav__link">
    Is docker-mailserver running in a rancher environment?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-can-i-authenticate-users-with-smtp_only" class="md-nav__link">
    How can I authenticate users with SMTP_ONLY?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#common-errors" class="md-nav__link">
    Common errors
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#using-behind-proxy" class="md-nav__link">
    Using behind proxy
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-about-updates" class="md-nav__link">
    What about updates
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#howto-adjust-settings-with-the-user-patchessh-script" class="md-nav__link">
    Howto adjust settings with the user-patches.sh script
  </a>
  
    <nav class="md-nav" aria-label="Howto adjust settings with the user-patches.sh script">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#special-case-patching-supervisord-config" class="md-nav__link">
    Special case patching supervisord config
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorials/installation-examples/" class="md-nav__link">
        Installation Examples
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      <label class="md-nav__link" for="__nav_6">
        Use Cases
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Use Cases" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Use Cases
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../uses-cases/forward-only-mailserver-with-ldap-authentication/" class="md-nav__link">
        Forward-Only Mailserver with LDAP
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="https://hub.docker.com/repository/docker/mailserver/docker-mailserver" class="md-nav__link">
        DockerHub
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#what-kind-of-database-are-you-using" class="md-nav__link">
    What kind of database are you using?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#where-are-emails-stored" class="md-nav__link">
    Where are emails stored?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-alter-the-running-mailserver-instance-without-relaunching-the-container" class="md-nav__link">
    How to alter the running mailserver instance without relaunching the container?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-can-i-sync-container-with-host-datetime-timezone" class="md-nav__link">
    How can I sync container with host date/time? Timezone?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-is-the-file-format" class="md-nav__link">
    What is the file format?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-about-backups" class="md-nav__link">
    What about backups?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-about-mail-state-folder" class="md-nav__link">
    What about mail-state folder?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-can-i-configure-my-email-client" class="md-nav__link">
    How can I configure my email client?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-can-i-manage-my-custom-spamassassin-rules" class="md-nav__link">
    How can I manage my custom Spamassassin rules?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-are-acceptable-sa_spam_subject-values" class="md-nav__link">
    What are acceptable SA_SPAM_SUBJECT values?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#can-i-use-nakedbare-domains-no-host-name" class="md-nav__link">
    Can I use naked/bare domains (no host name)?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#why-are-spamassassin-x-headers-not-inserted-into-my-sampledomaincom-subdomain-emails" class="md-nav__link">
    Why are Spamassassin x-headers not inserted into my sample.domain.com subdomain emails?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-can-i-make-spamassassin-learn-spam" class="md-nav__link">
    How can I make SpamAssassin learn spam?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-can-i-configure-a-catch-all" class="md-nav__link">
    How can I configure a catch-all?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-can-i-delete-all-the-e-mails-for-a-specific-user" class="md-nav__link">
    How can I delete all the e-mails for a specific user?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-do-i-have-more-control-about-what-spamassasin-is-filtering" class="md-nav__link">
    How do I have more control about what SPAMASSASIN is filtering?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-kind-of-ssl-certificates-can-i-use" class="md-nav__link">
    What kind of SSL certificates can I use?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#i-just-moved-from-my-old-mail-server-but-it-doesnt-work" class="md-nav__link">
    I just moved from my old mail server but "it doesn't work".
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#which-system-requirements-needs-my-container-to-run-docker-mailserver-effectively" class="md-nav__link">
    Which system requirements needs my container to run docker-mailserver effectively?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#is-docker-mailserver-running-in-a-rancher-environment" class="md-nav__link">
    Is docker-mailserver running in a rancher environment?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-can-i-authenticate-users-with-smtp_only" class="md-nav__link">
    How can I authenticate users with SMTP_ONLY?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#common-errors" class="md-nav__link">
    Common errors
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#using-behind-proxy" class="md-nav__link">
    Using behind proxy
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-about-updates" class="md-nav__link">
    What about updates
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#howto-adjust-settings-with-the-user-patchessh-script" class="md-nav__link">
    Howto adjust settings with the user-patches.sh script
  </a>
  
    <nav class="md-nav" aria-label="Howto adjust settings with the user-patches.sh script">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#special-case-patching-supervisord-config" class="md-nav__link">
    Special case patching supervisord config
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/docker-mailserver/docker-mailserver/edit/master/docs/config/troubleshooting/faq.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                  <h1>FAQ</h1>
                
                <h3 id="what-kind-of-database-are-you-using">What kind of database are you using?</h3>
<p>None! No database is required. Filesystem is the database.<br />
This image is based on config files that can be persisted using Docker volumes, and as such versioned, backed up and so forth.  </p>
<h3 id="where-are-emails-stored">Where are emails stored?</h3>
<p>Mails are stored in <code>/var/mail/${domain}/${username}</code>.<br />
You should use a <a href="https://medium.com/@ramangupta/why-docker-data-containers-are-good-589b3c6c749e#.uxyrp7xpu">data volume container</a> for <code>/var/mail</code> to persist data. Otherwise, your data may be lost.</p>
<h3 id="how-to-alter-the-running-mailserver-instance-without-relaunching-the-container">How to alter the running mailserver instance <em>without</em> relaunching the container?</h3>
<p>docker-mailserver aggregates multiple "sub-services", such as Postfix, Dovecot, Fail2ban, SpamAssasin, etc.  In many cases, on may edit a sub-service's config and reload that very sub-service, without stopping and relaunching the whole mail server.</p>
<p>In order to do so, you'll probably want to push your config updates to your server through a Docker volume, then restart the sub-service to apply your changes, using <code>supervisorctl</code>. For instance, after editing fail2ban's config: <code>supervisorctl restart fail2ban</code>.</p>
<p>See <a href="http://supervisord.org/running.html#running-supervisorctl">supervisorctl's documentation</a>.</p>
<p>Tips: to add/update/delete an email account, there is no need to restart postfix/dovecot service inside the container after using setup.sh script.
For more information, see <a href="https://github.com/tomav/docker-mailserver/issues/1639">issues/1639</a></p>
<h3 id="how-can-i-sync-container-with-host-datetime-timezone">How can I sync container with host date/time? Timezone?</h3>
<p>Share the host's <a href="https://www.freedesktop.org/software/systemd/man/localtime.html"><code>/etc/localtime</code></a> with the docker-mailserver container, using a Docker volume:  </p>
<pre><code>volumes:
  - /etc/localtime:/etc/localtime:ro
</code></pre>
<p>(optional) Add one line to <code>.env</code> or <code>env-mailserver</code> to set timetzone for container, for example:</p>
<pre><code>TZ=Europe/Berlin
</code></pre>
<p>check here for <a href="https://en.wikipedia.org/wiki/List_of_tz_database_time_zones"><code>tz name list</code></a></p>
<h3 id="what-is-the-file-format">What is the file format?</h3>
<p>All files are using the Unix format with <code>LF</code> line endings.
Please do not use <code>CRLF</code>.</p>
<h3 id="what-about-backups">What about backups?</h3>
<p>Assuming that you use <code>docker-compose</code> and a data volumes, you can backup your user mails like this:</p>
<pre><code>docker run --rm -ti \
  -v maildata:/var/mail \
  -v mailstate:/var/mail-state \
  -v /backup/mail:/backup \
  alpine:3.2 \
  tar czf /backup/mail-`date +%y%m%d-%H%M%S`.tgz /var/mail /var/mail-state

find /backup/mail -type f -mtime +30 -exec rm -f {} \;
</code></pre>
<h3 id="what-about-mail-state-folder">What about <code>mail-state</code> folder?</h3>
<p>This folder consolidates all data generated by the server itself to persist when you upgrade.
Example of data folder persisted: lib-amavis, lib-clamav, lib-fail2ban, lib-postfix, lib-postgrey, lib-spamassasin, lib-spamassassin, spool-postfix, ...</p>
<h3 id="how-can-i-configure-my-email-client">How can I configure my email client?</h3>
<p>Login are full email address (<code>user@domain.com</code>).  </p>
<pre><code># imap
username:           &lt;user1@domain.tld&gt;
password:           &lt;mypassword&gt;
server:             &lt;mail.domain.tld&gt;
imap port:          143 or 993 with ssl (recommended)
imap path prefix:   INBOX

# smtp
smtp port:          25 or 587 with ssl (recommended)
username:           &lt;user1@domain.tld&gt;
password:           &lt;mypassword&gt;
</code></pre>
<p>Please use <code>STARTTLS</code>.</p>
<h3 id="how-can-i-manage-my-custom-spamassassin-rules">How can I manage my custom Spamassassin rules?</h3>
<p>Antispam rules are managed in <code>config/spamassassin-rules.cf</code>.</p>
<h3 id="what-are-acceptable-sa_spam_subject-values">What are acceptable <code>SA_SPAM_SUBJECT</code> values?</h3>
<p>For no subject set <code>SA_SPAM_SUBJECT=undef</code>.</p>
<p>For a trailing white-space subject one can define the whole variable with quotes in <code>docker-compose.yml</code>:</p>
<pre><code class="language-docker-compose">    environment:
      - &quot;SA_SPAM_SUBJECT=[SPAM] &quot;
</code></pre>
<h3 id="can-i-use-nakedbare-domains-no-host-name">Can I use naked/bare domains (no host name)?</h3>
<p>Yes, but not without some configuration changes. Normally it is assumed that docker-mailserver runs on a host with a name, so the fully qualified host name might be <code>mail.example.com</code> with the domain <code>example.com</code>. The MX records point to <code>mail.example.com</code>. To use a bare domain where the host name is <code>example.com</code> and the domain is also <code>example.com</code>, change mydestination from:</p>
<p><code>mydestination = $myhostname, localhost.$mydomain, localhost</code></p>
<p>To:</p>
<p><code>mydestination = localhost.$mydomain, localhost</code></p>
<p>Add the latter line to config/postfix-main.cf. That should work. Without that change there will be warnings in the logs like:</p>
<p><code>warning: do not list domain example.com in BOTH mydestination and virtual_mailbox_domains</code></p>
<p>Plus of course mail delivery fails.</p>
<h3 id="why-are-spamassassin-x-headers-not-inserted-into-my-sampledomaincom-subdomain-emails">Why are Spamassassin x-headers not inserted into my sample.domain.com subdomain emails?</h3>
<p>In the default setup, amavis only applies Spamassassin x-headers into domains matching the template listed in the config  file 05-domain_id (in the amavis defaults). The default setup @local_domains_acl = ( ".$mydomain" ); does not match subdomains. To match subdomains, you can override the @local_domains_acl directive in the amavis user config file 50-user with @local_domains_maps = ("."); to match any sort of domain template. </p>
<h3 id="how-can-i-make-spamassassin-learn-spam">How can I make SpamAssassin learn spam?</h3>
<p>Put received spams in <code>.Junk/</code> imap folder using <code>SPAMASSASSIN_SPAM_TO_INBOX=1</code> and <code>MOVE_SPAM_TO_JUNK=1</code> and add a <em>user</em> cron like the following:</p>
<pre><code># This assumes you're having `environment: ONE_DIR=1` in the env-mailserver,
# with a consolidated config in `/var/mail-state`
#
# m h dom mon dow command
# Everyday 2:00AM, learn spam from a specific user
0 2 * * * docker exec mail sa-learn --spam /var/mail/domain.com/username/.Junk --dbpath /var/mail-state/lib-amavis/.spamassassin
</code></pre>
<p>If you run the server with docker-compose, you can leverage on docker configs and the mailserver's own cron. This is less problematic than the simple solution shown above, because it decouples the learning from the host on which the mailserver is running and avoids errors if the server is not running. </p>
<p>The following configuration works nicely:</p>
<p>create a <em>system</em> cron file:</p>
<pre><code class="language-sh"># in the docker-compose.yml root directory
mkdir cron
touch cron/sa-learn
chown root:root cron/sa-learn
chmod 0644 cron/sa-learn
</code></pre>
<p>edit the system cron file <code>nano cron/sa-learn</code>, and set an appropriate configuration:</p>
<pre><code># This assumes you're having `environment: ONE_DIR=1` in the env-mailserver,
# with a consolidated config in `/var/mail-state`
#
# m h dom mon dow user command
#
# Everyday 2:00AM, learn spam from a specific user
# spam: junk directory
0  2 * * * root  sa-learn --spam /var/mail/domain.com/username/.Junk --dbpath /var/mail-state/lib-amavis/.spamassassin
# ham: archive directories
15 2 * * * root  sa-learn --ham /var/mail/domain.com/username/.Archive* --dbpath /var/mail-state/lib-amavis/.spamassassin
# ham: inbox subdirectories
30 2 * * * root  sa-learn --ham /var/mail/domain.com/username/cur* --dbpath /var/mail-state/lib-amavis/.spamassassin
#
# Everyday 3:00AM, learn spam from all users of a domain
# spam: junk directory
0  3 * * * root  sa-learn --spam /var/mail/otherdomain.com/*/.Junk --dbpath /var/mail-state/lib-amavis/.spamassassin
# ham: archive directories
15 3 * * * root  sa-learn --ham /var/mail/otherdomain.com/*/.Archive* --dbpath /var/mail-state/lib-amavis/.spamassassin
# ham: inbox subdirectories
30 3 * * * root  sa-learn --ham /var/mail/otherdomain.com/*/cur* --dbpath /var/mail-state/lib-amavis/.spamassassin
</code></pre>
<p>with plain docker-compose:</p>
<pre><code class="language-docker-compose">version: &quot;2&quot;

services:
  mail:
    image: tvial/docker-mailserver:latest
    # ...
    volumes:
      - ./cron/sa-learn:/etc/cron.d/sa-learn
</code></pre>
<p>with <a href="https://docs.docker.com/engine/swarm/configs/">docker swarm</a>:</p>
<pre><code class="language-docker-compose">version: &quot;3.3&quot;

services:
  mail:
    image: tvial/docker-mailserver:latest
    # ...
    configs:
      - source: my_sa_crontab
        target: /etc/cron.d/sa-learn

configs:
  my_sa_crontab:
    file: ./cron/sa-learn
</code></pre>
<p>With the default settings, Spamassassin will require 200 mails trained for spam (for example with the method explained above) and 200 mails trained for ham (using the same command as above but using <code>--ham</code> and providing it with some ham mails). Until you provided these 200+200 mails, Spamassasin will not take the learned mails into account. For further reference, see the <a href="https://wiki.apache.org/spamassassin/BayesNotWorking">Spamassassin Wiki</a>.</p>
<h3 id="how-can-i-configure-a-catch-all">How can I configure a catch-all?</h3>
<p>Considering you want to redirect all incoming e-mails for the domain <code>domain.tld</code> to <code>user1@domain.tld</code>, add the following line to <code>config/postfix-virtual.cf</code>:</p>
<pre><code>@domain.tld user1@domain.tld
</code></pre>
<h3 id="how-can-i-delete-all-the-e-mails-for-a-specific-user">How can I delete all the e-mails for a specific user?</h3>
<p>First of all, create a special alias named <code>devnull</code> by editing <code>config/postfix-aliases.cf</code>:</p>
<pre><code>devnull:    /dev/null
</code></pre>
<p>Considering you want to delete all the e-mails received for <code>baduser@domain.tld</code>, add the following line to <code>config/postfix-virtual.cf</code>:</p>
<pre><code>baduser@domain.tld  devnull
</code></pre>
<h3 id="how-do-i-have-more-control-about-what-spamassasin-is-filtering">How do I have more control about what SPAMASSASIN is filtering?</h3>
<p>By default, SPAM and INFECTED emails are put to a quarantine which is not very straight forward to access. Several config settings are affecting this behavior:</p>
<p>First, make sure you have the proper thresholds set:</p>
<pre><code>SA_TAG=-100000.0
SA_TAG2=3.75
SA_KILL=100000.0
</code></pre>
<p>The very negative vaue in <code>SA_TAG</code> makes sure, that all emails have the Spamassasin headers included.
<code>SA_TAG2</code> is the actual threshold to set the YES/NO flag for spam detection. 
<code>SA_KILL</code> needs to be very high, to make sure nothing is bounced at all (<code>SA_KILL</code> superseeds <code>SPAMASSASSIN_SPAM_TO_INBOX</code>)</p>
<p>Make sure everything (including SPAM) is delivered to the inbox and not quarantined.</p>
<pre><code>SPAMASSASSIN_SPAM_TO_INBOX=1
</code></pre>
<p>Use <code>MOVE_SPAM_TO_JUNK=1</code> or create a sieve script which puts spam to the Junk folder.</p>
<pre><code>require [&quot;comparator-i;ascii-numeric&quot;,&quot;relational&quot;,&quot;fileinto&quot;];

if header :contains &quot;X-Spam-Flag&quot; &quot;YES&quot; {
  fileinto &quot;Junk&quot;;
} elsif allof (
   not header :matches &quot;x-spam-score&quot; &quot;-*&quot;,
   header :value &quot;ge&quot; :comparator &quot;i;ascii-numeric&quot; &quot;x-spam-score&quot; &quot;3.75&quot; ) {
  fileinto &quot;Junk&quot;;
}
</code></pre>
<p>Create a dedicated mailbox for emails which are infected/bad header and everything amavis is blocking by default and put its address into <code>config/amavis.cf</code></p>
<pre><code>$clean_quarantine_to      = &quot;amavis\@domain.com&quot;;
$virus_quarantine_to      = &quot;amavis\@domain.com&quot;;
$banned_quarantine_to     = &quot;amavis\@domain.com&quot;;
$bad_header_quarantine_to = &quot;amavis\@domain.com&quot;;
$spam_quarantine_to       = &quot;amavis\@domain.com&quot;;

</code></pre>
<h3 id="what-kind-of-ssl-certificates-can-i-use">What kind of SSL certificates can I use?</h3>
<p>You can use the same certificates you use with another mail server.<br />
The only thing is that we provide a <code>self-signed</code> certificate tool and a <code>letsencrypt</code> certificate loader.</p>
<h3 id="i-just-moved-from-my-old-mail-server-but-it-doesnt-work">I just moved from my old mail server but "it doesn't work".</h3>
<p>If this migration implies a DNS modification, be sure to wait for DNS propagation before opening an issue.
Few examples of symptoms can be found <a href="https://github.com/tomav/docker-mailserver/issues/95">here</a> or <a href="https://github.com/tomav/docker-mailserver/issues/97">here</a>.<br />
This could be related to a modification of your <code>MX</code> record, or the IP mapped to <code>mail.my-domain.tld</code>. Additionally, <a href="https://intodns.com/">validate your DNS configuration</a>. </p>
<p>If everything is OK regarding DNS, please provide <a href="https://guides.github.com/features/mastering-markdown/">formatted logs</a> and config files. This will allow us to help you.</p>
<p>If we're blind, we won't be able to do anything.</p>
<h3 id="which-system-requirements-needs-my-container-to-run-docker-mailserver-effectively">Which system requirements needs my container to run <code>docker-mailserver</code> effectively?</h3>
<p>1 core and 1GB of RAM + swap partition is recommended to run <code>docker-mailserver</code> with clamav.
Otherwise, it could work with 512M of RAM.</p>
<p>Please note that clamav can consume a lot of memory, as it reads the entire signature database into RAM. Current figure is about 850M and growing. If you get errors about clamav or amavis failing to allocate memory you need more RAM or more swap and of course docker must be allowed to use swap (not always the case). If you can't use swap at all you may need 3G RAM.</p>
<h3 id="is-docker-mailserver-running-in-a-rancher-environment">Is <code>docker-mailserver</code> running in a <a href="http://rancher.com/rancher/">rancher environment</a>?</h3>
<p>Yes, by Adding the Environment Variable <code>PERMIT_DOCKER: network</code>.</p>
<p><strong>WARNING</strong>: Adding the docker network's gateway to the list of trusted hosts, e.g. using the <code>network</code> or <code>connected-networks</code> option, can create an <a href="https://en.wikipedia.org/wiki/Open_mail_relay"><strong>open relay</strong></a>, <a href="https://github.com/tomav/docker-mailserver/issues/1405#issuecomment-590106498">for instance</a> if IPv6 is enabled on the host machine but not in Docker. (<a href="https://github.com/tomav/docker-mailserver/issues/1405">#1405</a>)</p>
<h3 id="how-can-i-authenticate-users-with-smtp_only">How can I authenticate users with SMTP_ONLY?</h3>
<p>See https://github.com/tomav/docker-mailserver/issues/1247 for an example.</p>
<p><em>ToDo: Write a HowTo/UseCase/Tutorial about authentication with SMTP_ONLY.</em></p>
<h3 id="common-errors">Common errors</h3>
<pre><code>warning: connect to Milter service inet:localhost:8893: Connection refused
# DMARC not running
# =&gt; /etc/init.d/opendmarc restart

warning: connect to Milter service inet:localhost:8891: Connection refused
# DKIM not running
# =&gt; /etc/init.d/opendkim restart

mail amavis[1459]: (01459-01) (!)connect to /var/run/clamav/clamd.ctl failed, attempt #1: Can't connect to a UNIX socket /var/run/clamav/clamd.ctl: No such file or directory
mail amavis[1459]: (01459-01) (!)ClamAV-clamd: All attempts (1) failed connecting to /var/run/clamav/clamd.ctl, retrying (2)
mail amavis[1459]: (01459-01) (!)ClamAV-clamscan av-scanner FAILED: /usr/bin/clamscan KILLED, signal 9 (0009) at (eval 100) line 905.
mail amavis[1459]: (01459-01) (!!)AV: ALL VIRUS SCANNERS FAILED
# Clamav is not running (not started or because you don't have enough memory)
# =&gt; check requirements and/or start Clamav
</code></pre>
<h3 id="using-behind-proxy">Using behind proxy</h3>
<p>Add to <code>/etc/postfix/main.cf</code> :</p>
<pre><code>
proxy_interfaces = X.X.X.X (your public IP) 

</code></pre>
<h3 id="what-about-updates">What about updates</h3>
<p>You can of course use a own script or every now and then pull &amp;&amp; stop &amp;&amp; rm &amp;&amp; start the images but there are tools available for this.
There is a page in the <a href="Update-and-cleanup">Update and cleanup</a> wiki page that explains how to use it the docker way.</p>
<h3 id="howto-adjust-settings-with-the-user-patchessh-script">Howto adjust settings with the user-patches.sh script</h3>
<p>Suppose you want to change a number of settings that are not listed as variables or add things to the server that are not included?</p>
<p>This docker-container has a built-in way to do post-install processes. If you place a script called <strong>user-patches.sh</strong> in the config directory it will be run after all configuration files are set up, but before the postfix, amavis and other daemons are started.</p>
<p>The config file I am talking about is this volume in the yml file: </p>
<p><code>- ./config/:/tmp/docker-mailserver/</code></p>
<p>To place such a script you can just make it in the config dir, for instance like this:</p>
<p><code>cd ./config</code></p>
<p><code>touch user-patches.sh</code></p>
<p><code>chmod +x  user-patches.sh</code></p>
<p>and then fill it with suitable code. </p>
<p>If you want to test it you can move into the running container, run it and see if it does what you want. For instance:</p>
<p><code>./setup.sh debug login    # start shell in container</code></p>
<p><code>cat /tmp/docker-mailserver/user-patches.sh  #check the file</code></p>
<p><code>/tmp/docker-mailserver/user-patches.sh  ## run the script</code></p>
<p><code>exit</code></p>
<p>You can do a lot of things with such a script. You can find an example user-patches.sh script here: <a href="https://github.com/hanscees/dockerscripts/blob/master/scripts/tomav-user-patches.sh">example user-patches.sh script</a></p>
<h4 id="special-case-patching-supervisord-config">Special case patching supervisord config</h4>
<p>It seems worth noting, that the <code>user-patches.sh</code> gets executed trough supervisord. If you need to patch some supervisord config (e.g. <code>/etc/supervisor/conf.d/saslauth.conf</code>), the patching happens too late.
An easy workaround is to make the <code>user-patches.sh</code> reload the supervisord config after patching it:</p>
<pre><code class="language-bash">#!/bin/bash
sed -i 's/rimap -r/rimap/' /etc/supervisor/conf.d/saslauth.conf
supervisorctl update
</code></pre>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        <a href="../../../advanced/ipv6/" class="md-footer__link md-footer__link--prev" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              IPv6
            </div>
          </div>
        </a>
      
      
        <a href="../../../tutorials/installation-examples/" class="md-footer__link md-footer__link--next" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Installation Examples
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            <p>&copy <a href="https://github.com/docker-mailserver"><em>Docker Mailserver Organization</em></a><br/><span>This project is licensed under the MIT license.</span></p>
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../../..", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}, "search": "../../../assets/javascripts/workers/search.fb4a9340.min.js", "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.ca5457b8.min.js"></script>
      
    
  </body>
</html>